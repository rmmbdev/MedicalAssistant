FROM python:3.10-slim-buster

WORKDIR /app

ENV PYTHONUNBUFFERED=1
ENV PYTHONPATH=/app

COPY src/bot /app
COPY src/celery /app
COPY src/utils /app
COPY pyproject.toml /app

RUN ls -la /app

RUN pip install poetry
RUN python -m poetry config virtualenvs.create false
RUN python -m poetry install --no-interaction --no-ansi

CMD ["python", "/bot/main.py"]